// Navigation Components
// Styles for top banner, navigation, and mobile menu

// Top Banner Base
.top-banner {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background: var(--card-background);
  border-bottom: 1px solid var(--border-color);
  backdrop-filter: blur(8px);
  transition: transform 0.3s ease, opacity 0.3s ease;
  
  &.sticky-banner {
    position: fixed;
  }
  
  &.banner-hidden {
    transform: translateY(-100%);
    opacity: 0.8;
  }
  
  // Ensure content doesn't hide behind banner
  & + * {
    margin-top: 4rem;
  }
}

// Banner Container
.banner-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem;
}

// Banner Content Layout
.banner-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 4rem;
  gap: 2rem;
  
  @media (max-width: 768px) {
    gap: 1rem;
  }
}

// Banner Brand
.banner-brand {
  flex-shrink: 0;
  
  .banner-brand-link {
    text-decoration: none;
    color: var(--text-color);
    font-weight: 700;
    font-size: 1.25rem;
    transition: color 0.2s ease;
    
    &:hover {
      color: var(--primary-color);
    }
  }
  
  .banner-brand-name {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }
}

// Banner Navigation
.banner-nav {
  flex: 1;
  display: flex;
  justify-content: center;
  
  @media (max-width: 768px) {
    display: none;
  }
}

// Banner Toggle (Mobile)
.banner-toggle {
  display: none;
  background: none;
  border: none;
  color: var(--text-color);
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 4px;
  transition: background-color 0.2s ease;
  
  &:hover {
    background: var(--border-color);
  }
  
  @media (max-width: 768px) {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .banner-toggle-icon {
    width: 20px;
    height: 20px;
  }
}

// Mobile Navigation
.banner-mobile-nav {
  display: none;
  border-top: 1px solid var(--border-color);
  background: var(--card-background);
  
  &.nav-open {
    display: block;
  }
  
  @media (max-width: 768px) {
    .nav-component {
      padding: 1rem;
    }
  }
}

// Navigation Component Base
.nav-component {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  
  // Banner variant - Clean wiggle effect
  &.nav-banner {
    position: relative;
    isolation: isolate;
    anchor-name: --hovered-link;
    padding: 8px;
    border-radius: 8px;
    
    // The wiggle effect element
    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 50%;
      right: 50%;
      bottom: 100%;
      border-radius: 8px;
      position-anchor: --hovered-link;
      opacity: 0;
      pointer-events: none;
      z-index: -1;
      background: var(--border-color);
      backdrop-filter: blur(4px);
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      
      transition: all 500ms
        linear(
          0,
          0.029 1.6%,
          0.123 3.5%,
          0.651 10.6%,
          0.862 14.1%,
          1.002 17.7%,
          1.046 19.6%,
          1.074 21.6%,
          1.087 23.9%,
          1.086 26.6%,
          1.014 38.5%,
          0.994 46.3%,
          1
        );
    }
    
    // Show wiggle effect when hovering any nav item
    &:has(li:hover)::before {
      opacity: 1;
      top: anchor(top);
      left: anchor(left);
      right: anchor(right);
      bottom: anchor(bottom);
    }

    .nav-links {
      padding: 0;
      margin: 0;
      list-style: none;
      display: flex;
      align-items: center;
      gap: 2rem; // Restore original gaps
      
      @media (max-width: 992px) {
        gap: 1.5rem;
      }
    }
    
    li {
      // Each li gets the anchor name when hovered (like the working example)
      &:hover {
        anchor-name: --hovered-link;
      }
    }
    
    .nav-link {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
      color: var(--text-light);
      font-weight: 500;
      font-size: 0.9rem;
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      transition: all 0.2s ease;
      
      &:hover {
        color: var(--text-color);
        background: var(--border-color);
      }
      
      .nav-icon {
        width: 16px;
        height: 16px;
        flex-shrink: 0;
      }
      
      .nav-text {
        white-space: nowrap;
      }
      
      &.nav-external {
        color: var(--text-secondary);
        
        &:hover {
          color: var(--primary-color);
        }
      }
    }
  }
  
  // Mobile variant
  &.nav-mobile {
    flex-direction: column;
    align-items: stretch;
    gap: 0.5rem;
    
    .nav-links {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .nav-link {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      color: var(--text-light);
      font-weight: 500;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      transition: all 0.2s ease;
      
      &:hover {
        color: var(--text-color);
        background: var(--border-color);
      }
      
      .nav-icon {
        width: 18px;
        height: 18px;
        flex-shrink: 0;
      }
      
      .nav-text {
        flex: 1;
      }
      
      &.nav-external {
        color: var(--text-secondary);
        border-top: 1px solid var(--border-color);
        margin-top: 0.5rem;
        
        &:first-of-type {
          margin-top: 1rem;
        }
        
        &:hover {
          color: var(--primary-color);
        }
      }
    }
  }
  
  // Footer variant (for future use)
  &.nav-footer {
    .nav-links {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
    }
    
    .nav-link {
      text-decoration: none;
      color: var(--text-light);
      font-size: 0.9rem;
      transition: color 0.2s ease;
      
      &:hover {
        color: var(--text-color);
      }
    }
  }
}

// Dark mode adjustments
.dark-mode {
  .top-banner {
    background: rgba(var(--card-background-rgb), 0.9);
    backdrop-filter: blur(12px);
  }
  
  .banner-toggle:hover {
    background: var(--text-secondary);
  }
}

// Animation for smooth transitions
@keyframes slideDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.banner-mobile-nav.nav-open {
  animation: slideDown 0.3s ease;
}

// Responsive adjustments
@media (max-width: 480px) {
  .banner-content {
    height: 3.5rem;
    padding: 0 0.5rem;
  }
  
  .banner-brand .banner-brand-link {
    font-size: 1.1rem;
  }
  
  .nav-mobile .nav-link {
    padding: 0.625rem 0.75rem;
    font-size: 0.9rem;
  }
}

// Ensure proper spacing for sticky banner
body:has(.top-banner.sticky-banner) {
  main {
    margin-top: 4rem;
  }
}

// Alternative for browsers that don't support :has()
.has-sticky-banner {
  main {
    margin-top: 4rem;
  }
}
